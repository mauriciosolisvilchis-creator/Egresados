<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Admin{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-light bg-light mb-4">
      <div class="container-fluid px-2">
        <div class="d-flex w-100 align-items-center">
          <!-- Logo izquierdo -->
          <div class="left-logo">
            <a class="logo-link" href="{{ url_for('dashboard') }}">
              <img src="{{ url_for('static', filename='images/umb.png') }}" alt="UMB" class="brand-logo">
            </a>
          </div>

          <!-- Título centro - oculto en móvil -->
          <div class="nav-brand-center d-none d-md-block">
            <div class="brand-title">Universidad Mexiquense del Bicentenario</div>
            <div class="brand-sub">San José del Rincón</div>
          </div>

          <!-- Toggle button para móvil -->
          <button class="navbar-toggler ms-auto me-2" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <!-- Menú navegación colapsable -->
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
              {% if session.get('admin') %}
              <li class="nav-item"><a class="nav-link {% if request.endpoint == 'dashboard' %}fw-bold{% endif %}" href="{{ url_for('dashboard') }}">Dashboard</a></li>
              <li class="nav-item"><a class="nav-link {% if request.endpoint and (request.endpoint == 'egresados_list' or request.endpoint.startswith('egresado')) %}fw-bold{% endif %}" href="{{ url_for('egresados_list') }}">Egresados</a></li>
              <li class="nav-item"><a class="nav-link" href="{{ url_for('logout') }}">Cerrar sesión</a></li>
              {% endif %}
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <div class="container">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, msg in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
              {{ msg }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      {% block content %}{% endblock %}
    </div>

    <footer class="mt-auto py-3 bg-light">
      <div class="container text-center">
        <small class="text-muted">Copyrigth © 2026 Control Egresados UMB. Todos los derechos reservados</small>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Auto-cerrar alertas después de 5 segundos
      document.addEventListener('DOMContentLoaded', function() {
        const alerts = document.querySelectorAll('.alert');
        alerts.forEach(alert => {
          setTimeout(function() {
            const bsAlert = new bootstrap.Alert(alert);
            bsAlert.close();
          }, 5000);
        });
      });

      // Prevenir ir atrás en el navegador
      (function() {
        window.addEventListener('popstate', function(event) {
          history.pushState(null, null, location.href);
        });
        history.pushState(null, null, location.href);
      })();
    </script>
  </body>
</html>